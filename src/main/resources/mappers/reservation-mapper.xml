<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="reservationMapper">

	<!-- Guest -->
	<resultMap type="Guest" id="GuestResultSet" >
        <result property="gstNo" column="GST_NO"/>
        <result property="gstName" column="GST_NAME"/>
        <result property="gstEmail" column="GST_EMAIL"/> <!-- PATIENT_NAME 추가 -->
       	<result property="gstPhone" column="GST_PHONE"/>
        <result property="gstBirth" column="GST_BIRTH"/>
        <result property="gstGender" column="GST_GENDER"/>
        <result property="gstAddress" column="GST_ADDRESS"/>
    </resultMap>

    <!-- ReservationWithVaccineResult 설정 -->
    <resultMap id="ReservationWithVaccineResult" type="com.project.trinity.reservation.model.vo.Reservation">
        <id property="resNo" column="RES_NO"/>
        <result property="userNo" column="USER_NO"/>
        <result property="hosNo" column="HOS_NO"/>
         <result property="patientName" column="PATIENT_NAME"/> <!-- PATIENT_NAME 추가 -->
       	<result property="patientBirthday" column="PATIENT_BIRTHDAY"/>
        <result property="resDate" column="RES_DATE"/>
        <result property="resTime" column="RES_TIME"/>
        <result property="resCategory" column="RES_CATEGORY"/>
        <result property="resContent" column="RES_CONTENT"/>
    </resultMap>
    
    <!-- 일반 진료 회원 예약 -->
    <insert id="insertgReservation" parameterType="com.project.trinity.reservation.model.vo.Reservation">
    	INSERT INTO GENERAL_RESERVATION
    	(	USER_NO, 
	    	HOS_NO, 
	    	G_PATIENT_NAME, 
	    	G_PATIENT_BIRTHDAY,
	    	G_RES_DATE, 
	    	G_RES_TIME, 
	    	G_RES_SUBJECT, 
	    	G_RES_CONTENT, 
	    	G_RES_GENDER
    	)
		VALUES
    	(
    	#{userNo},
        #{hosNo},
        (SELECT USER_NAME FROM MEMBER WHERE USER_NO = #{userNo}),
        (SELECT BIRTHDAY FROM MEMBER WHERE USER_NO = #{userNo}),
        TO_DATE(#{resDate}, 'YYYY-MM-DD'),
        #{resTime},
        #{subject},
        #{content},
        (SELECT GENDER FROM MEMBER WHERE USER_NO = #{userNo}))
    </insert>
    
    <!-- 게스트 삽입 -->
    <insert id="insertgReservation" parameterType="com.project.trinity.reservation.model.vo.Reservation">
    	INSERT INTO GUEST
    	(	
            GST_NAME,
            GST_EMAIL,
            GST_PHONE,
            GST_BIRTH,
            GST_GENDER
    	)
		VALUES
    	(
            #{userName},
            #{email},
            #{phone},
            #{birthday},
            #{gender}
        )
    </insert>
    
    
    
</mapper>
